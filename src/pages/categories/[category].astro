---
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
	const posts = await getCollection('posts', ({ data }) => data.draft !== true);
	const categories = [...new Set(posts.map(post => post.data.category))];

	return categories.map(category => ({
		params: { category },
	}));
}

const { category } = Astro.params;

// 重定向到分页第一页
return Astro.redirect(`/categories/${encodeURIComponent(category)}/page/1`);
---
